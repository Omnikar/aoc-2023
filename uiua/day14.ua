+@\0&ru0 0
⊜∘≠@\n.

ShiftLeft ← (
  ☇1⇡⊟⊃(-1⧻⊢)⧻.
  ∧(⍜(⊏⊙⊡|↻≍".O".)+0_1°⊟)
)

Left ← ;⍢(ShiftLeft.⊙;|¬≍):[]
Up ← ⍜⍉Left
Down ← ⍜⇌Up
Right ← ⍜⍉Down
Spin ← Right Down Left Up

PartTwo ← (
  ⍢(⊃Spin⊂|¬∊)⊃Spin¤
  ⊡◿⧻,⊃(-:1e9)↘⊗⊙.⊙⇌
)

(Up|PartTwo) -1⋕⊡1&args

/+♭×+1⇡⧻.=@O⇌
